<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>3&nbsp;Differential Equations and Spiking Neuron Models</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="figure.css" title="default"/><link rel="stylesheet" type="text/css" href="autobib.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript">
(function() {document.write('<scr' + 'ipt type="text/javascript" src="MathJax/MathJax.js?config=default"></scr' + 'ipt>');})();
</script><script type="text/javascript" src="figure.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Computational Modeling for Psychology</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Introductory_Material.html" class="tocviewlink" data-pltdoc="x">Introduction and Computing Requirements</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Computation_and_Cognition.html" class="tocviewlink" data-pltdoc="x">What is Computation and is Cognition Computable?</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Differential Equations and Spiking Neuron Models</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Neural_Networks.html" class="tocviewlink" data-pltdoc="x">Neural Networks</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="Projects.html" class="tocviewlink" data-pltdoc="x">Topics for Final Projects</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>3&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Differential Equations and Spiking Neuron Models</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.1&nbsp;</td><td><a href="#%28part._.Differential_.Equations_and_.Spiking_.Neuron_.Models%29" class="tocviewlink" data-pltdoc="x">Differential Equations and Spiking Neuron Models</a></td></tr><tr><td align="right">3.2&nbsp;</td><td><a href="#%28part._.Integrate_and_.Fire_.Neuron%29" class="tocviewlink" data-pltdoc="x">Integrate and Fire Neuron</a></td></tr><tr><td align="right">3.3&nbsp;</td><td><a href="#%28part._.Hodgkin._and._.Huxley%29" class="tocviewlink" data-pltdoc="x">Hodgkin and Huxley Model of the Action Potential</a></td></tr><tr><td align="right">3.4&nbsp;</td><td><a href="#%28part._.Morris_.Lecar_.Model%29" class="tocviewlink" data-pltdoc="x">Morris Lecar Model</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._.Differential_.Equations_and_.Spiking_.Neuron_.Models%29" class="tocsubseclink" data-pltdoc="x">Differential Equations and Spiking Neuron Models</a></td></tr><tr><td><span class="tocsublinknumber">3.1.1<tt>&nbsp;</tt></span><a href="#%28part._.Spiking._.Neuron._.Models%29" class="tocsubseclink" data-pltdoc="x">Goals</a></td></tr><tr><td><span class="tocsublinknumber">3.1.2<tt>&nbsp;</tt></span><a href="#%28part._.The_.Action_.Potential_-_a_very_short_review%29" class="tocsubseclink" data-pltdoc="x">The Action Potential -<wbr></wbr> a very short review</a></td></tr><tr><td><span class="tocsublinknumber">3.1.2.1<tt>&nbsp;</tt></span><a href="#%28part._.Multiple_.Ways_to_.Say_the_.Same_.Thing%29" class="tocsubseclink" data-pltdoc="x">Multiple Ways to Say the Same Thing</a></td></tr><tr><td><span class="tocsublinknumber">3.1.3<tt>&nbsp;</tt></span><a href="#%28part._.Derivatives_are_.Slopes%29" class="tocsubseclink" data-pltdoc="x">Derivatives are Slopes</a></td></tr><tr><td><span class="tocsublinknumber">3.1.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Use_your_computer_as_a_tool_for_exploration%29" class="tocsubseclink" data-pltdoc="x">Use your computer as a tool for exploration</a></td></tr><tr><td><span class="tocsublinknumber">3.1.4<tt>&nbsp;</tt></span><a href="#%28part._use-deriv-to-solve%29" class="tocsubseclink" data-pltdoc="x">Using Derivatives to Solve Problems With a Computer</a></td></tr><tr><td><span class="tocsublinknumber">3.1.4.1<tt>&nbsp;</tt></span><a href="#%28part._.What_is_the_square_root_of_128_%29" class="tocsubseclink" data-pltdoc="x">What is the square root of 128?</a></td></tr><tr><td><span class="tocsublinknumber">3.1.4.1.1<tt>&nbsp;</tt></span><a href="#%28part._.Working_.Through_an_.Example%29" class="tocsubseclink" data-pltdoc="x">Working Through an Example</a></td></tr><tr><td><span class="tocsublinknumber">3.1.4.2<tt>&nbsp;</tt></span><a href="#%28part._.Damped_.Oscillators%29" class="tocsubseclink" data-pltdoc="x">Damped Oscillators</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._.Integrate_and_.Fire_.Neuron%29" class="tocsubseclink" data-pltdoc="x">Integrate and Fire Neuron</a></td></tr><tr><td><span class="tocsublinknumber">3.2.1<tt>&nbsp;</tt></span><a href="#%28part._.History_of_the_.Integrate_and_.Fire_.Model%29" class="tocsubseclink" data-pltdoc="x">History of the Integrate and Fire Model</a></td></tr><tr><td><span class="tocsublinknumber">3.2.1.1<tt>&nbsp;</tt></span><a href="#%28part._.Louis_.Lapicque_-_.Earlier_.Computational_.Neuroscientist%29" class="tocsubseclink" data-pltdoc="x">Louis Lapicque -<wbr></wbr> Earlier Computational Neuroscientist</a></td></tr><tr><td><span class="tocsublinknumber">3.2.1.2<tt>&nbsp;</tt></span><a href="#%28part._.Lord_.Adrian_and_the_.All-or-.None_.Action_.Potential%29" class="tocsubseclink" data-pltdoc="x">Lord Adrian and the All-<wbr></wbr>or-<wbr></wbr>None Action Potential</a></td></tr><tr><td><span class="tocsublinknumber">3.2.2<tt>&nbsp;</tt></span><a href="#%28part._sec~3aiandf%29" class="tocsubseclink" data-pltdoc="x">The Integrate and Fire Equation</a></td></tr><tr><td><span class="tocsublinknumber">3.2.2.1<tt>&nbsp;</tt></span><a href="#%28part._.Electronics_.Background%29" class="tocsubseclink" data-pltdoc="x">Electronics Background</a></td></tr><tr><td><span class="tocsublinknumber">3.2.2.2<tt>&nbsp;</tt></span><a href="#%28part._.Formula_.Discussion_.Questions%29" class="tocsubseclink" data-pltdoc="x">Formula Discussion Questions</a></td></tr><tr><td><span class="tocsublinknumber">3.2.2.3<tt>&nbsp;</tt></span><a href="#%28part._.Coding_up_the_.Integrate_and_.Fire_.Neuron%29" class="tocsubseclink" data-pltdoc="x">Coding up the Integrate and Fire Neuron</a></td></tr><tr><td><span class="tocsublinknumber">3.2.2.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Class_.Exercise__.Adding_a_refractory_period_to_the_.Integrate_and_.Fire_model%29" class="tocsubseclink" data-pltdoc="x">Class Exercise:<span class="mywbr"> &nbsp;</span> Adding a refractory period to the Integrate and Fire model</a></td></tr><tr><td><span class="tocsublinknumber">3.2.3<tt>&nbsp;</tt></span><a href="#%28part._.Integrate_and_.Fire_.Homework%29" class="tocsubseclink" data-pltdoc="x">Integrate and Fire Homework</a></td></tr><tr><td><span class="tocsublinknumber">3.3<tt>&nbsp;</tt></span><a href="#%28part._.Hodgkin._and._.Huxley%29" class="tocsubseclink" data-pltdoc="x">Hodgkin and Huxley Model of the Action Potential</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Background_and_.Motivation%29" class="tocsubseclink" data-pltdoc="x">Background and Motivation</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.1<tt>&nbsp;</tt></span><a href="#%28part._.Biographical_.Sources%29" class="tocsubseclink" data-pltdoc="x">Biographical Sources</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.2<tt>&nbsp;</tt></span><a href="#%28part._.Model_.Description__detailed_%29" class="tocsubseclink" data-pltdoc="x">Model Description (detailed)</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.3<tt>&nbsp;</tt></span><a href="#%28part._.Comments_and_.Steps_in_.Coding_the_.Hodgkin_.Huxley_.Model%29" class="tocsubseclink" data-pltdoc="x">Comments and Steps in Coding the Hodgkin Huxley Model</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Test_your_understanding%29" class="tocsubseclink" data-pltdoc="x">Test your understanding</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.4<tt>&nbsp;</tt></span><a href="#%28part._.It_s_.Differential_.Equations_.All_the_.Way_.Down%29" class="tocsubseclink" data-pltdoc="x">It&rsquo;s Differential Equations All the Way Down</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.5<tt>&nbsp;</tt></span><a href="#%28part._.Getting_.Started%29" class="tocsubseclink" data-pltdoc="x">Getting Started</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.5.1<tt>&nbsp;</tt></span><a href="#%28part._.Constants%29" class="tocsubseclink" data-pltdoc="x">Constants</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.6<tt>&nbsp;</tt></span><a href="#%28part._.Alpha_and_.Beta_.Formulas%29" class="tocsubseclink" data-pltdoc="x">Alpha and Beta Formulas</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.7<tt>&nbsp;</tt></span><a href="#%28part._.Updating_the_.Voltage%29" class="tocsubseclink" data-pltdoc="x">Updating the Voltage</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.7.1<tt>&nbsp;</tt></span><a href="#%28part._.Demonstrating_the_.Hodgkin-.Huxley_.Model%29" class="tocsubseclink" data-pltdoc="x">Demonstrating the Hodgkin-<wbr></wbr>Huxley Model</a></td></tr><tr><td><span class="tocsublinknumber">3.3.1.8<tt>&nbsp;</tt></span><a href="#%28part._.Hodgkin_and_.Huxley_.Homework%29" class="tocsubseclink" data-pltdoc="x">Hodgkin and Huxley Homework</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="#%28part._ref~3ahandh%29" class="tocsubseclink" data-pltdoc="x">Hodgkin-<wbr></wbr>Huxley References</a></td></tr><tr><td><span class="tocsublinknumber">3.4<tt>&nbsp;</tt></span><a href="#%28part._.Morris_.Lecar_.Model%29" class="tocsubseclink" data-pltdoc="x">Morris Lecar Model</a></td></tr><tr><td><span class="tocsublinknumber">3.4.1<tt>&nbsp;</tt></span><a href="#%28part._.Work_in_.Progress%29" class="tocsubseclink" data-pltdoc="x">Work in Progress</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Computation_and_Cognition.html" title="backward to &quot;2 What is Computation and is Cognition Computable?&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Computational Modeling for Psychology&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Neural_Networks.html" title="forward to &quot;4 Neural Networks&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>3<tt>&nbsp;</tt><a name="(part._.D.Es._and._.Spikes)"></a>Differential Equations and Spiking Neuron Models</h3><h4>3.1<tt>&nbsp;</tt><a name="(part._.Differential_.Equations_and_.Spiking_.Neuron_.Models)"></a>Differential Equations and Spiking Neuron Models</h4><h5>3.1.1<tt>&nbsp;</tt><a name="(part._.Spiking._.Neuron._.Models)"></a>Goals</h5><p>Why are Differential Equations an important technique for computational modelling in psychology and neuroscience?</p><p>Work on the modeling of the action potential eventually resulted in <a href="https://www.nobelprize.org/prizes/medicine/1963/summary/">Nobel Prizes</a>. The Hodgkin-Huxley equations that resulted from this work are differential equations. Subsequent models, even very marked simplifications such as the Integrate and Fire model, are also differential equations. When you rely on a simulation software that allows you to create populations of such neurons you are using, at least indirectly, a differential equation. It is worth knowing what they are.</p><p><div class="SIntrapara">Beyond that, the idea of a differential equation is a very intuitive and useful notion. You can recast the example of the <a href="Computation_and_Cognition.html#%28part._forgetting%29" data-pltdoc="x">What Is Cognition?</a> forgetting curve as a differential equation in which the change in the strength of a memory over time is proportional to the current strength of the memory  as a function of time. </div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Exponentials show up a lot in neuroscience and psychology. When you see a rate of change in a quantity that is proportional to the magnitude of that quantity there is an exponential hidden in there somewhere.</p></blockquote></blockquote></blockquote></div></p><p>Further, modern computers and their powers mean that we can often use differential equations in our models by naively implementing their effects as a series of very tiny steps. We might gain insight if we knew more about how to solve differential equations analytically, but often, if our goals our practical, that is running a simulation to see the result, we can be ignorant of differential equations at that level, and just deploy them as another practical tool. Just like you can now use software to implement Monte Carlo simulations in statistics without knowing the full details of the theory mathematically.</p><p>This gives us the following goals for this section:</p><ol><li><p>Learn what a Differential Equation is as a mathematical entity,</p></li><li><p>Get an intuition for differential equations by thinking of them as slopes,</p></li><li><p>Learn how they emerge as a natural effort to account for changing quantities in neuroscience and psychology,</p></li><li><p>Put this altogether by writing programs to implement the integrate and fire point neuron model and a version of the Hodgkin-Huxley neuron model.</p></li></ol><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>In preparation for things to come you might try to remember (or look up) what is the integral of one over x? In symbols, what is <span class="math">\int \frac{1}{x}~ dx</span>?</p></blockquote></blockquote></blockquote><h5>3.1.2<tt>&nbsp;</tt><a name="(part._.The_.Action_.Potential_-_a_very_short_review)"></a>The Action Potential - a very short review</h5><p>Our goal is to use differential equations in code written to simulate spiking neurons. Therefore, we ought to remind ourselves about the basics of what is a neuronal action potential.</p><p><div class="SIntrapara">Give yourself 10 minutes to brush up on what an action potential is. First, try and draw an action potential:
</div><div class="SIntrapara"><ul><li><p>What are the axes?</p></li><li><p>What ion causes the upward deflection?</p></li><li><p>What causes the repolarization?</p></li><li><p>Who discovered the action potential?</p></li><li><p>Who won the Nobel Prize for characterizing the ionic events of the action potential experimentally and building a mathematical model?</p></li></ul></div></p><p>Did you draw     <a href="https://commons.wikimedia.org/w/index.php?curid=44114666">this</a>?</p><p><span style="font-weight: bold">An aside: Notation</span></p><p>Mathematics is full of notation. And one person&rsquo;s notation is another person&rsquo;s jargon. The key thing is not to let yourself be scared off. Often the motivation for mathematical notation is just convenience: condensing something that would take a long time to say or write into an abbreviated form. It is the equivalent of saying "meh" or "lol".  Mathematical notation is just a technical emoji. You probably know the mathematical idea that is being represented; you just don&rsquo;t know the abbreviation that is being used. So, just like you can teach granma the meaning of TMI you can with a little bit of practice get used to the Greek symbols that appear so often in mathematical presentations.</p><p>As a first exercise, write out in long hand what is meant by the
following:</p><p><div class="math">\sum_{\forall x \in \left\{ 1 , 2 , 3 \right \}} x ~=~ 6</div>
Did you write: <a href="../sections/notation-answer.txt">this?</a></p><h5>3.1.2.1<tt>&nbsp;</tt><a name="(part._.Multiple_.Ways_to_.Say_the_.Same_.Thing)"></a>Multiple Ways to Say the Same Thing</h5><p>Another thing to note about mathematical notation is that it often provides more than one way to say the same thing. Which notation is used depends on context and the technical community the work is intended for. Computer scientists frequently use <span class="stt">i</span> as a variable for indexing a loop. To the mathematician it is the complex part of an imaginary number <span class="math">i~=~\sqrt{-1}</span>, but engineers use <span class="stt">j</span> instead. Here are some of the many different ways you may see the derivative depicted.</p><p>Leibniz notation: <span class="math">\frac{dx}{dt}</span></p><p>Physicists often use this for derivatives with respect to time (<span class="stt">t</span>): <span class="math">\dot{x}</span></p><p>Mathematicians often use the variable itself as a representation for the function and use the number of "primes" to indicate how many derivatives to take: <span class="math">x&rsquo;</span></p><p>Or they may make the variable representing the function explicit if they think that will make their reasoning clearer in the present context: <span class="math">f&rsquo;(x)</span></p><p>This is called operator notation. You won&rsquo;t see it as much, but when doing certain kinds of proofs or reasoning more abstractly it can be much more convenient: <span class="math">D~f</span></p><h5>3.1.3<tt>&nbsp;</tt><a name="(part._.Derivatives_are_.Slopes)"></a>Derivatives are Slopes</h5><p>There may be many ways to write out the notation for a derivative, but the uniting concept behind them is as "rates of change." They are essentially just the slopes you learned about in secondary school. The old "rise over run" where the length of the run is made very, very small.</p><p>You might want to pause here and make sure you remember what a slope is.</p><p><div class="SIntrapara"><ul><li><p>Can you write the equation to find the slope of a line?</p></li><li><p>How would you apply this to a curve and not a line?</p></li><li><p>When in doubt return to definition. What is the definition of a slope of a function?</p></li></ul></div><div class="SIntrapara">We will see momentarily how to go from our basic understanding of the slope of a line to <span style="font-weight: bold">generalize</span> it to also include curves. This notion of generalizing is often a key step in developing an idea for modeling.</div></p><h5>3.1.3.1<tt>&nbsp;</tt><a name="(part._.Use_your_computer_as_a_tool_for_exploration)"></a>Use your computer as a tool for exploration</h5><p>Demonstrating something mathematically can give a great deal of satisfaction and ultimately is the guarantor of whether something is correct. Often we want to know more than whether something is correct in the abstract, we want to see specific examples. Sometimes pencil and paper are the best approach, but often we can do the same thing more quickly and more extensively by using our computer. Let&rsquo;s digress to use our computer for visualizing ideas about slopes. You should try to get these to work in Dr. Racket.</p><p><div class="SIntrapara">Example:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">xs</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">ys</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="hspace">&nbsp;</span><span class="RktVal">8</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lines</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">vector</span><span class="hspace">&nbsp;</span><span class="RktSym">xs</span><span class="hspace">&nbsp;</span><span class="RktSym">ys</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:title</span><span class="hspace">&nbsp;</span><span class="RktVal">"A Line: What is it's slope?"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_2.png" alt="image" width="406" height="406"/></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Example:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">function</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expt</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">function</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">12</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">16</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:title</span><span class="hspace">&nbsp;</span><span class="RktVal">"A curve (of what?) showing the slope at a point."</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_3.png" alt="image" width="406" height="406"/></p></td></tr></table></blockquote></div></p><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_4.png" alt="image" width="406" height="406"/></p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Derivatives are Instantaneous Slopes</p></blockquote></blockquote></blockquote><p>These plots are intended to demonstrate the idea that locally everything is linear. If you calculate the slope for your curve exactly like you do for a line you will get something that starts to look more and more like a line the smaller your "run" gets. The idea is that you pick two points that are "close enough" and your derivative becomes "close enough." At least with a computer. Mathematically, you just keep going to the limit.</p><p><a name="(elem._derivative)"></a>
<span style="font-weight: bold">Definition of the Derivative</span>
<div class="math">\frac{df}{dx} = \lim_{h \to 0}\frac{f(x + h) - f(x)}{(x + h) - x}\tag{D}</div>
<br/></p><h5>3.1.4<tt>&nbsp;</tt><a name="(part._use-deriv-to-solve)"></a>Using Derivatives to Solve Problems With a Computer</h5><h5>3.1.4.1<tt>&nbsp;</tt><a name="(part._.What_is_the_square_root_of_128_)"></a>What is the square root of 128?</h5><p>We want to know the value of <span class="math">x</span> that makes <span class="math">128 =x^2</span> true?</p><p><span class="refelem"><span class="refcolumn"><span class="refcontent">Always use the computer for the busy work when you can. Your computer can solve many mathematical problems for you. For example, requiring <span class="stt">symalg</span> we can programatically find that the derivative of <span class="math">x^2</span> is
<span class="math">2 x</span>. Look at the code for this <span class="stt">margin-note</span> and you will see how I computed that with racket (and then typeset it).</span></span></span></p><ul><li><p>Come up with a guess.</p></li><li><p>Calculate the error.</p></li><li><p>Adjust your guess based on the error.</p></li><li><p>This adjustment will use the derivative.</p></li></ul><h5>3.1.4.1.1<tt>&nbsp;</tt><a name="(part._.Working_.Through_an_.Example)"></a>Working Through an Example</h5><p>Let&rsquo;s say we want to solve for <span class="math">x</span> when <span class="math">x^2 = 128</span>. How might we start? When in doubt, guess!</p><p>How much is your guess off?</p><p><div class="math">\mbox{Error} = \mbox{(my guess)}^2 - \mbox{128}</div></p><p>What we want to do now is adjust our guess. Since we know how much our function changes its output for each adjustment in the input, <span class="refelem"><span class="refcolumn"><span class="refcontent">How do we know this? Our derivative is a <span style="font-style: italic">rate of change</span>.</span></span></span> we can revise our guess based on this necessary adjustment. If we are still wrong, we just repeat the process.</p><p>To get there let us consider representing the ratio of how our function&rsquo;s output changes for changes in input. We can just make things concrete.</p><p><div class="math">\frac{\Delta~\mbox{output}}{\Delta~\mbox{input}} = \frac{\mbox{function(input_1)} - \mbox{function(input_0)}}{\mbox{input_1} - \mbox{input_0}}</div></p><p>If you take a look at the definition of the derivative <a href="#%28elem._derivative%29" data-pltdoc="x">(equation D)</a> above you will see the resemblance, except for the absence of the limit. When trying to solve this problem we don&rsquo;t initially know both inputs, but we do know that when we put in the solution to our problem we will get 128. And we also know that we can compute the derivative. A bit of rearranging and renaming give us.<span class="refelem"><span class="refcolumn"><span class="refcontent">Can you map the steps I took to get this equation from the one above?</span></span></span></p><p>The equation of a frictionless spring is:</p><p><a name="(elem._spring)"></a>
<div class="math">\frac{d^2 s}{dt^2} = -P~s\tag{S}</div>
<br/></p><p>where &rsquo;s&rsquo; refers to space, &rsquo;t&rsquo; refers to time, and &rsquo;P&rsquo; is a constant, often called the spring constant, that indicates how stiff or springy the spring is.</p><p>Imagine that we knew this derivative. It would tell us how much space the spring head would move for a given, very small, increment of time. We could then just add this to our current position to get the new position and repeat. This method of using a derivative to iterate forward is sometimes called the Euler method.</p><p>Returning to our definition of the derivative:</p><p><div class="math">\frac{s(t + \Delta t) - s(t)}{\Delta t} = velocity \approx \frac{d s}{d t}</div></p><p>But our spring equation is not given in terms of the velocity it is given in terms of the acceleration which is the second derivative. Therefore, to find our new position we need the velocity, but we only have the acceleration. However, if we knew the acceleration and the velocity we could use that to calculate the new velocity. Unfortunately we don&rsquo;t know the velocity, unless ... , maybe we could just assume something. Let&rsquo;s say it is zero because we have started our process where we have stretched the spring, and are holding it, just before letting it go.</p><p>How will our velocity change with time?</p><p><div class="math">\frac{v(t + \Delta t) - v(t)}{\Delta t} = acceleration \approx \frac{d v}{d t} = \frac{d^2 s}{d t^2}</div></p><p>And we have a formula for this. We can now bootstrap our simulation.</p><p>Note the similiarity of the two functions. You could write a helper function that was generic to this pattern of old value + rate of change times the  time step, and just used the pertinent values.</p><p>How do we know the formula for acceleration? We were given it in <a href="#%28elem._spring%29" data-pltdoc="x">Equation S</a> above.</p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">require</span><span class="hspace">&nbsp;</span><span class="RktVal">"./code/spring.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">spring-results</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">release-spring</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lines</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">vector</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">fourth</span><span class="hspace">&nbsp;</span><span class="RktSym">spring-results</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">third</span><span class="hspace">&nbsp;</span><span class="RktSym">spring-results</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_5.png" alt="image" width="406" height="406"/></p></td></tr></table></blockquote></div></p><h5>3.1.4.2<tt>&nbsp;</tt><a name="(part._.Damped_.Oscillators)"></a>Damped Oscillators</h5><p>Provide the code for the damped oscillator. It has the formula of</p><p><div class="math">\frac{d^2 s}{dt^2} = -P~s(t) - k~v(t)</div></p><p>This should really only need to change a couple of lines to update the model to be able to handle the damped version as well. You might want to edit <a href="./../code/spring.rkt">spring.rkt</a>.</p><h4>3.2<tt>&nbsp;</tt><a name="(part._.Integrate_and_.Fire_.Neuron)"></a>Integrate and Fire Neuron</h4><p>In this section we take a look at the history and math of the computational model of neuron firing called "Integrate and Fire" (I&amp;F).
 The I&amp;F model uses math essentially the same as the spring example.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Is the integrate and fire model used much in modeling in the present time.? <a href="https://scholar.google.com/scholar?as_ylo=2020&amp;q=%22integrate+and+fire%22+neuron&amp;hl=en&amp;as_sdt=7,39">Answer</a>.</p></blockquote></blockquote></blockquote><h5>3.2.1<tt>&nbsp;</tt><a name="(part._.History_of_the_.Integrate_and_.Fire_.Model)"></a>History of the Integrate and Fire Model</h5><h5>3.2.1.1<tt>&nbsp;</tt><a name="(part._.Louis_.Lapicque_-_.Earlier_.Computational_.Neuroscientist)"></a>Louis Lapicque - Earlier Computational Neuroscientist</h5><p><a href="https://link.springer.com/content/pdf/10.1007/s00422-007-0190-0.pdf">Modern Commentary on Lapique&rsquo;s Neuron Model</a></p><blockquote class="Figure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="Lapicque_laboratoire.png" alt="" width="321" height="500"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3alapique-lab))" x-target-lift="Figure"></a>Figure&nbsp;4: </span>The Lapique Lab at the Sorbonne early 1900s</span></p></blockquote><p><a href="http://www.snv.jussieu.fr/brette/papers/Lap07.pdf">Original Lapique Paper (scanned; pdf)</a></p><p><a href="https://fr.wikipedia.org/wiki/Louis_Lapicque">Brief Biographical Details of Lapicque</a>.</p><h5>3.2.1.2<tt>&nbsp;</tt><a name="(part._.Lord_.Adrian_and_the_.All-or-.None_.Action_.Potential)"></a>Lord Adrian and the All-or-None Action Potential</h5><p>One of the first demonstrations of the all-or-none nature of the neuronal action potential was made by Lord Adrian. Lord Adrian was an interesting scientific figure how asserted that some of his prowess at electrophysiology stemmed from his interest in and training in fencing.</p><p><div class="SIntrapara">To answer the questions:
</div><div class="SIntrapara"><ul><li><p>When was the action potential demonstrated?</p></li><li><p>What was the experimental animal used by Adrian?</p></li></ul></div><div class="SIntrapara">Consult this <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1420429/pdf/jphysiol01990-0084.pdf">this pdf for answers.</a></div></p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Want more details? There is an excellent free book available <a href="https://lcnwww.epfl.ch/gerstner/SPNM/SPNM.html"><span style="font-weight: bold">Spiking Neurons</span>.</a> They also have another more modern book out too <a href="http://neuronaldynamics.epfl.ch/online/index.html"><span style="font-weight: bold">Neuronal Dynamics</span>.</a></p></blockquote></blockquote></blockquote><h5>3.2.2<tt>&nbsp;</tt><a name="(part._sec~3aiandf)"></a>The Integrate and Fire Equation</h5><p>While Hodgkin and Huxley provided the first robust computational model of the neuronal action potential there model is quite complex, as we will soon see. Is all that complexity necessary? That of course depends on the nature of the scientific question, and if we are primarily intersted in whether a spike has or has not occured, and not the ionic events that produced the spike, we may find our experimental questions dealt with much more concisely by a much simpler model of neuronal spiking: the leaky integrate and fire model.</p><p>The formula for the leaky integrate and fire neuron is:</p><p><a name="(elem._iandf-eq)"></a>
<div class="math">\tau \frac{dV(t)}{dt} = -V(t) + R~I(t) .\tag{I}</div>
<br/></p><p>In the next sections we will describe how this simplification came to be, and use it as the basis for learning some of the elementary electrical laws and relations upon which it is based.</p><h5>3.2.2.1<tt>&nbsp;</tt><a name="(part._.Electronics_.Background)"></a>Electronics Background</h5><p>The following questions are the ones we need answers to to derive our integrte and fire model.</p><ol><li><p>What is Ohm&rsquo;s Law?</p></li><li><p>What is Kirchoff&rsquo;s Point Rule?</p></li><li><p>What is Capacitance?</p></li><li><p>What is the relation between current and capacitance?</p></li></ol><h5>3.2.2.2<tt>&nbsp;</tt><a name="(part._.Formula_.Discussion_.Questions)"></a>Formula Discussion Questions</h5><p>To understand our formula clearly we should review the meaning of the key symbols and notation.</p><ol><li><p>What does <span class="math">\frac{dV}{dt}</span> mean?</p></li><li><p>What does <span class="math">\frac{1}{\tau}</span> mean?</p></li><li><p>Why does the voltage term on the right have a negative sign?</p></li><li><p>What is <span class="math">I(t)</span>?</p></li></ol><p>To derive our equation we need to put all these fact together.</p><p>We recall that just like we used the derivative to help us figure out where the spring would be some small increment of time into the future, we use the same approach to compute our future voltage. That future voltage will also include a term that reflects an additional current that we have "experimentally" injected.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Can you tell why, looking at the integrate and fire equation, if we don&rsquo;t reach the firing threshold, we see an exponential decay?</p></blockquote></blockquote></blockquote><p>Deriving the IandF Equation
<div class="math">\begin{align*}
     I &amp;= I_R + I_C &amp; (a) \\
       &amp;= I_R + C\frac{dV}{dt} &amp; (b)\\
       &amp;= \frac{V}{R} + C\frac{dV}{dt} &amp; (c)\\
     RI  &amp;= V + RC\frac{dV}{dt} &amp; (d) \\
     \frac{1}{\tau} (RI-V)  &amp;= \frac{dV}{dt} &amp; (e)\\
     \end{align*}</div></p><ul><li><p>a: Kirchoff&rsquo;s point rule,</p></li><li><p>b: the relationship between current, charge, and their derivatives</p></li><li><p>c: Ohm&rsquo;s law</p></li><li><p>d:multiply through by R</p></li><li><p>e: rearrange and define <span class="math">\tau</span></p></li></ul><h5>3.2.2.3<tt>&nbsp;</tt><a name="(part._.Coding_up_the_.Integrate_and_.Fire_.Neuron)"></a>Coding up the Integrate and Fire Neuron</h5><p>Most of the integrate and fire implementation is conceptually and practically identical to the spring example. You assume a starting voltate (initial state) and then you update that voltage using the differential equation for how voltage changes with time (<span class="math">\frac{dV}{dt}</span>).</p><p>There is one critical difference though. Unlike real neurons the Integrate and Fire neuron model does not have a natural threshold and spiking behavior. You pick a threshold and everyone time your voltage reaches that threshold you designate a spike and reset the voltage.</p><p>What I added below is a strictly cosmetic amendment that changes the first value after the threshold to a number much higher than the threshold so that when plotted it creates the visual appearance of a spike.</p><h5>3.2.2.3.1<tt>&nbsp;</tt><a name="(part._.Class_.Exercise__.Adding_a_refractory_period_to_the_.Integrate_and_.Fire_model)"></a>Class Exercise: Adding a refractory period to the Integrate and Fire model</h5><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>What is the refractory period for a neuron?</p></blockquote></blockquote></blockquote><p>In class make sure you can get the <a href="./../code/iandf.rkt">integrate and fire model</a> working in Dr. Racket. After you get the basic model working trying altering the input current to see how that affects the number of spikes and the regularity of their spiking.</p><p>Next, change the form of the input current to be something other than a constant. I suggest trying a sine wave. This will give you a chance to sample some of racket&rsquo;s potential.</p><p>Find out how to take the sin of a number. Then learn how to <span class="stt">map</span> the sin function over a list of numbers. If you use <span class="stt">in-range</span> you can create a stream of numbers from a minimum to a maximun for a given step size. Then you may want to shift up or scale all the numbers to make them non-zero. This could be done by mapping again. The <span class="stt">map</span> function is very powerful and allows you to avoid writing a lot of lengthy looping code.</p><p>After you have done that edit the code to include a refractory period. First, decide on the logic of how to do this and only after that start editing the code to implement it.</p><p>The next examples walk through the code and describe some of the ideas.</p><p><div class="SIntrapara"><span style="font-weight: bold"><span style="font-style: italic">Defining our parameters:</span></span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="hspace">&nbsp;</span><span class="RktVal">0.05</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">max-t</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">init-t</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">start-time</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">stop-time</span><span class="hspace">&nbsp;</span><span class="RktVal">6.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cap</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">res</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">threshold</span><span class="hspace">&nbsp;</span><span class="RktVal">3.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">spike-display</span><span class="hspace">&nbsp;</span><span class="RktVal">8.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">voltage</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">injection-current</span><span class="hspace">&nbsp;</span><span class="RktVal">4.3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">injection-time</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktSym">start-time</span><span class="hspace">&nbsp;</span><span class="RktSym">stop-time</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">tau</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">res</span><span class="hspace">&nbsp;</span><span class="RktSym">cap</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>This is a good habit to develop with your code.
Do not "hard code" in values for variables that you will have to write in multiple locations in a file.
It makes it hard to update and debug your code.
Give sensible and short names to things you will use in your code.
Then define values for those at the top of your code.
This gives you one place to look for explanations and reminders, and also gives you a place where when you make a single change it will propagate through your code.</p><p><div class="SIntrapara"><span style="font-weight: bold"><span style="font-style: italic">Euler&rsquo;s Method (again):</span></span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">old-value</span><span class="hspace">&nbsp;</span><span class="RktSym">rate-of-change</span><span class="hspace">&nbsp;</span><span class="RktSym">time-step</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">rate-of-change</span><span class="hspace">&nbsp;</span><span class="RktSym">time-step</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">old-value</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><p>This is the same updating rule that we used in the spring example.
It is a rewriting of the definition of the derivative.
This is sometimes referred to as <a href="https://en.wikipedia.org/wiki/Euler_method">Euler&rsquo;s method</a>.</p><p><div class="SIntrapara"><span style="font-weight: bold"><span style="font-style: italic">Helper functions:</span></span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dv-dt</span><span class="hspace">&nbsp;</span><span class="RktSym">localres</span><span class="hspace">&nbsp;</span><span class="RktSym">locali</span><span class="hspace">&nbsp;</span><span class="RktSym">localv</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">tau</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">localres</span><span class="hspace">&nbsp;</span><span class="RktSym">locali</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">localv</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">#:lower</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">lower</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">injection-time</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:upper</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">upper</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cdr</span><span class="hspace">&nbsp;</span><span class="RktSym">injection-time</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:if-true</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">if-true</span><span class="hspace">&nbsp;</span><span class="RktSym">injection-current</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:if-false</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">if-false</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">and</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&gt;=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">lower</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">upper</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">if-true</span><span class="hspace">&nbsp;</span><span class="RktSym">if-false</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">voltage-choice</span><span class="hspace">&nbsp;</span><span class="RktSym">curr-volt</span><span class="hspace">&nbsp;</span><span class="RktSym">spike-status</span><span class="hspace">&nbsp;</span><span class="RktPn">#:thr</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">thr</span><span class="hspace">&nbsp;</span><span class="RktSym">threshold</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:sd</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">sd</span><span class="hspace">&nbsp;</span><span class="RktSym">spike-display</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cond</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">and</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">curr-volt</span><span class="hspace">&nbsp;</span><span class="RktSym">thr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">not</span><span class="hspace">&nbsp;</span><span class="RktSym">spike-status</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">sd</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">spike-status</span><span class="hspace">&nbsp;</span><span class="RktVal">#i0.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktVal">#t</span><span class="hspace">&nbsp;</span><span class="RktSym">curr-volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><p>Just as we were given the equation for a spring, here we are given the equation for the I&amp;F neuron, which we translate from math to code. In addition, I created some smaller "helper" functions. I like a style that gives my functions default values. Then I don&rsquo;t have to enter so many arguments when I call the function. This, of course, only makes sense if there are values which you input to your function and that rarely change. I also find it convenient to use a style where I have keywords for my functions. Then I can change the order that I enter things. It does make my code longer, because I have to type the keywords when specifying the input to my functions. This is what I am doing with the lines that look like: <span class="RktMeta"></span><span class="RktPn">#:if-false</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">[</span><span class="RktSym">if-false</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">0.0</span><span class="RktPn">]</span><span class="RktMeta"></span></p><p>It would be possible to collapse all this into one big function, but that would be harder for me to understand, and harder for you to understand.
In general, try to write short little functions that do one thing.
Then you can chain those small functions together to accomplish the larger task.</p><p><div class="SIntrapara"><span style="font-weight: bold"><span style="font-style: italic">Running our model:</span></span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run-iandf-sim</span><span class="hspace">&nbsp;</span><span class="RktPn">#:tolerance</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">tolerance</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">#:max-time</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">max-time</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">#:max-iter</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">max-iter</span><span class="hspace">&nbsp;</span><span class="RktVal">10000</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">for*/fold</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">accum</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:result</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reverse</span><span class="hspace">&nbsp;</span><span class="RktSym">accum</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">in-range</span><span class="hspace">&nbsp;</span><span class="RktSym">max-iter</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:break</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">max-time</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">spike</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abs</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">spike-display</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">tolerance</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">values</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">voltage-choice</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dv-dt</span><span class="hspace">&nbsp;</span><span class="RktSym">res</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">spike</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">accum</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">require</span><span class="hspace">&nbsp;</span><span class="RktVal">"./code/iandf.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">iandf-results</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run-iandf-sim</span><span class="hspace">&nbsp;</span><span class="RktPn">#:max-time</span><span class="hspace">&nbsp;</span><span class="RktVal">10.0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lines</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">vector</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktSym">iandf-results</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">third</span><span class="hspace">&nbsp;</span><span class="RktSym">iandf-results</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_6.png" alt="image" width="406" height="406"/></p></td></tr></table></blockquote></div></p><p>Though things may look more complex than the spring example, it is because I have so many more <span style="font-style: italic">local</span> variables to define.
The basic flow is still just a <span style="font-weight: bold">loop</span>.</p><p>Visualizations can be essential in helping you to see and understand the function of your computational program. Thus, while it is only cosmetic, I find the addition of the apparent spike helps me to see what the output of my simulation is. In another context, e.g. if were only counting spikes this decorative element would be un-needed complexity.</p><h5>3.2.3<tt>&nbsp;</tt><a name="(part._.Integrate_and_.Fire_.Homework)"></a>Integrate and Fire Homework</h5><p>The Integrate and Fire homework has two components. One practical and one theoretical.</p><p>Practically, submit an integrate and fire racket program that alters mine in some meaningful way. You might change the plot or the type of current input. You might examine how the results depends on the size of the time step used. Just something to show that you can edit code and keep it working.</p><p>Theoretically, look at <a href="https://redwood.berkeley.edu/wp-content/uploads/2018/08/mainen-sejnowski.pdf">this article (pdf)</a> and tell me how you feel our integrate and fire model compares to these actual real world spiking data when both are give constant input. What are the implications for using the integrate and fire model as a model of neuronal function?</p><h4>3.3<tt>&nbsp;</tt><a name="(part._.Hodgkin._and._.Huxley)"></a>Hodgkin and Huxley Model of the Action Potential</h4><h5>3.3.1<tt>&nbsp;</tt><a name="(part._.Background_and_.Motivation)"></a>Background and Motivation</h5><p>Hodgkin and Huxley, the people as well as their model, provide a nice example for how to structure one&rsquo;s education to enable one to do work that combines mathematics, models, and empirical data. Each was a scientist from one side of the aisle who sought training from the other.</p><p>Another lesson taught by the Hodgkin and Huxley model is a meta lesson: you may not understand in the beginning what your true problem even is. You need to be prepared for it to appear, and when it does to be able to attack it with the methods appropriate to its nature. Rather than being the man with a hammer and seeing everything as a nail, you need to carry a Swiss Army knife.</p><h5>3.3.1.1<tt>&nbsp;</tt><a name="(part._.Biographical_.Sources)"></a>Biographical Sources</h5><p>To learn more about these remarkable individuals and their careers you can consult the biographies of the Nobel Foundation. The Nobel Prize organization keeps biographies of all recipients <a href="https://www.nobelprize.org/prizes/medicine/1963/hodgkin/biographical/">Hodgkin</a>,  <a href="https://www.nobelprize.org/prizes/medicine/1963/huxley/biographical/">Huxley</a>.</p><p>This <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3424716/pdf/tjp0590-2571.pdf">article (pdf)</a> is a nice summary of the work done by Hodgkin and Huxley. You might look for how long it took Huxley to calculate his simulation of one action potential numerically using essentially the same method we will be using. Compare how long it takes you to how long it took him.</p><h5>3.3.1.2<tt>&nbsp;</tt><a name="(part._.Model_.Description__detailed_)"></a>Model Description (detailed)</h5><p>I will not be describing the Hodgkin and Huxley model in detail as there are many other sources that do an excellent job and are online and freely available. One recommended source is Gersnter&rsquo;s <a href="https://lcnwww.epfl.ch/gerstner/SPNM/node14.html#table-HH1">book&rsquo;s chapter</a>. Gerstner goes into more detail than I do. If you have problems getting things to work, or just want a more detailed mathematical explanation this is an excellent resource.</p><h5>3.3.1.3<tt>&nbsp;</tt><a name="(part._.Comments_and_.Steps_in_.Coding_the_.Hodgkin_.Huxley_.Model)"></a>Comments and Steps in Coding the Hodgkin Huxley Model</h5><p>Some introductory reminders and admonitions:</p><p>The current going in to the cell is intended to represent what an electrophysiologist would inject in their laboratory setting, or what might be changed by the input from other neurons.
The total current coming out of the neuron is the sum of the capacitance (due to the lipid bilayer), and the resistance (due to the ion channels).
This is <span style="font-weight: bold">Kirchoff&rsquo;s</span> rule implemented in the Hodgkin and Huxley model.</p><p>Recall that in the Integrate and Fire model we lumped all our ionic
events together into one term:</p><p><div class="math">\tau \frac{dV(t)}{dt} = -V(t) + R~I(t)</div></p><p>The Hodgkin and Huxley model is basically the same as the Integrate and Fire model. What differs is that total conductance is decomposed into three parts where we have a resistance <span style="font-style: italic">for each ion channel</span>.
The rule for currents in parallel is to apply Kirchoff&rsquo;s and Ohm&rsquo;s laws realizing that they all experience the same voltage, thus the currents sum. The Hodgkin and Huxley model has components for Sodium (Na), Potassium (K), and negative anions (still lumped as "leak" l).</p><p><div class="math">\sum_i I_R(t) = \bar{g}_{Na} m^3 h l(V(t) - E_{Na}) + \bar{g}_{K} n^4 (V(t) - E_{K}) + \bar{g}_{L} (V(t) - E_{L})</div></p><p><div class="math">I_{tot} = I_r + I_C</div></p><p>By the same logic as for the integrate land fire <span class="math">I_C = c~\frac{dV}{dt}</span>.</p><p><div class="math">I_{tot} = \bar{g}_{Na} m^3 h (V(t) l- E_{Na}) + \bar{g}_{K} n^4 (V(t) - E_{K}) + \bar{g}_{L} (V(t) - E_{L}) + c~\frac{dV}{dt}</div></p><p>If you rearrange terms you can get the <span class="math">\frac{dV}{dt}</span> on one side of the equation by itself.</p><p><div class="math">c~\frac{dV}{dt} = I_{tot} - (\bar{g}_{Na} m^3 h (V(t) - E_{Na}) + \bar{g}_{K} n^4 (V(t) - E_{K}) + \bar{g}_{L} (V(t) - E_{L}))\tag 1</div></p><h5>3.3.1.3.1<tt>&nbsp;</tt><a name="(part._.Test_your_understanding)"></a>Test your understanding</h5><p>You cannot program what you don&rsquo;t understand. A major headache in any programming task comes from starting to write your code too soon. Your time to completion will often be shorter if you delay starting the writing of your code until you can confirm a solid understanding of the intent of your code and the flow of the algorithm you are implementing. It is a mistake to think that programming will bring understanding. Programming may bring you new insights or help you extend your understanding, but it cannot turn a confused implementation into a working one. Sometimes you think you understand something, and in the act of coding you find that you really do not. Or else that there are elements of the original problem that were under specified. At this point you should stop writing code, and go back to the blackboard to work through what it is you are trying to do. Make your coding about implementing an idea. Do not expect it to deliver the idea.</p><p>So, in that light, and before you start coding, ask yourself,</p><ol><li><p>What are the <span class="math">\bar{g}_*</span> terms?</p></li><li><p>What are the <span class="math">E_{*}</span> terms?</p></li><li><p>What do m,n, and h represent?</p></li><li><p>Where did these equations come from?</p></li></ol><h5>3.3.1.4<tt>&nbsp;</tt><a name="(part._.It_s_.Differential_.Equations_.All_the_.Way_.Down)"></a>It&rsquo;s Differential Equations All the Way Down</h5><p>Although the Hodgkin and Huxley model uses the same mathematics as the Integrate and Fire model, and we will use the same Euler&rsquo;s method to step forward and calculate model terms that evolve over time, this model is more complex in two ways that make the coding more intricate. First, it has multiple derivatives and derivatives at multiple levels. Each of the <span style="font-style: italic">m</span>, <span style="font-style: italic">n</span>, and <span style="font-style: italic">h</span> terms are also changing and regulated by a differential equation. They are dependent on voltage. For example, <div class="math">\dot{m} = \alpha_m (V)(1 - m) - \beta_m (V) m</div>.</p><p><div class="SIntrapara"><span style="font-weight: bold">Test Your Understanding</span>
</div><div class="SIntrapara"><ol><li><p>Each of the m,n, and h terms have their own equation of exactly the same form, but with their unique alphas and betas (that is what the subscript means).</p></li><li><p>What does the V in parentheses mean?</p></li><li><p>When they were finally sequenced (decades later), what do you think was the number of sub-units that the sodium and potassium channels were found to have?</p></li></ol></div></p><h5>3.3.1.5<tt>&nbsp;</tt><a name="(part._.Getting_.Started)"></a>Getting Started</h5><p>You will need to make some assumptions to get your initial conditions.</p><ul><li><p>If you allow <span class="math">t \rightarrow \infty \mbox{, then } \frac{dV}{dt}=?</span></p></li><li><p>You assume that it goes to zero; that is, you reach steady state. Then you can solve for some of the constants.</p></li><li><p>Where do the constants come from?</p></li><li><p>They come from experiments, and you use what you are given.</p></li><li><p>Assume the following constants - they are set to assume a resting potential of zero (instead of what and why doesn&rsquo;t this matter)?</p></li><li><p>These constants also work out to enforce a capacitance of 1</p></li></ul><h5>3.3.1.5.1<tt>&nbsp;</tt><a name="(part._.Constants)"></a>Constants</h5><p><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><span style="font-weight: bold">Constant</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-weight: bold">Value</span></p></td></tr><tr><td><p>ena</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>115</p></td></tr><tr><td><p>gna</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>120</p></td></tr><tr><td><p>ek</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>-12</p></td></tr><tr><td><p>gk</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>36</p></td></tr><tr><td><p>el</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>10.6</p></td></tr><tr><td><p>gl</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0.3</p></td></tr></table></p><p><span style="font-weight: bold">WARNING</span> These constants are adjusted to make the resting potential 0 and the capacitance 1.0. If you want your model to have a biological resting potential you will need to adjust these values, but when you think about it the scale is rather arbitrary. What does water freeze at 0 or -32? Well it depends on the scale: centigrade or fahrenheit. Same for neurons. Why not use a scale that makes the math simpler. Focus on the relative behavior not some absolute, and rather arbitrary, numbers.</p><h5>3.3.1.6<tt>&nbsp;</tt><a name="(part._.Alpha_and_.Beta_.Formulas)"></a>Alpha and Beta Formulas</h5><p><span class="math">\alpha_{n}(V_{m})={\frac {0.01(10-V_l{m})}{\exp {\big (}{\frac{10-V_{m}}{10}}{\big )}-1}}</span></p><p><span class="math">\alpha_{m}(V_{m})={\frac {0.1(25-V_{lm})}{\exp {\big (}{\frac {25-V_{m}}{10}}{\big )}-1}}</span></p><p><span class="math">\alpha _{h}(V_{m})=0.07\exp {\bigg (l}{\frac {-V_{m}}{20}}{\bigg )}</span></p><p><span class="math">\beta _{n}(V_{m})=0.125\exp {\bigg (l}{\frac {-V_{m}}{80}}{\bigg )}</span></p><p><span class="math">\beta _{m}(V_{m})=4\exp {\bigg (}{\frac {-V_{m}}{18}}{\bigg )}</span></p><p><div class="SIntrapara"><span class="math">\beta_{h}(V_{m})={\frac {1}{\exp {\big (}{\frac {30-V_{m}}{10}}{\big)}+1}}</span>
</div><div class="SIntrapara"><blockquote class="SubFlow" style="background-color:linen;"><p><span style="font-weight: bold">Programming Concept: Hash Tables</span>. Often when writing a more complex program you will have collections of values that go together conceptually. If you declare each as its own variable your functions that need the entire collection can require very long strings of arguments. It is often convenient to group such variables into a collection type recognized by your programming language. Python dictionaries are one approach. R and other languages may make it easier to use <span style="font-style: italic">objects</span>. In this instance I am using a Racket hash table. I provide a name and a value and then an overall name for the table of name-value pairs.</p></blockquote></div><div class="SIntrapara"><p><div class="SIntrapara">Defining the Basic Neuron Parameters</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-details</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">dt</span><span class="hspace">&nbsp;</span><span class="RktVal">0.05</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">init-t</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">start-time</span><span class="hspace">&nbsp;</span><span class="RktVal">10.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">stop-time</span><span class="hspace">&nbsp;</span><span class="RktVal">34.05</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">cap</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">init-v</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">injection-current</span><span class="hspace">&nbsp;</span><span class="RktVal">20.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">ena</span><span class="hspace">&nbsp;</span><span class="RktVal">115.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">gna</span><span class="hspace">&nbsp;</span><span class="RktVal">120.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">ek</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>2.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">gk</span><span class="hspace">&nbsp;</span><span class="RktVal">36.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">el</span><span class="hspace">&nbsp;</span><span class="RktVal">10.6</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">gl</span><span class="hspace">&nbsp;</span><span class="RktVal">0.3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p></div></p><p><div class="SIntrapara">All the Helper Functions:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.01</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">2.5</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">2.5</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.07</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>.0</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">20.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.125</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>.0</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">80.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">4.0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>.0</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">18.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">3.0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">lower</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">start-time</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">upper</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">stop-time</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">if-true</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">injection-current</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">if-false</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">and</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&gt;=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">lower</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">upper</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">if-true</span><span class="hspace">&nbsp;</span><span class="RktSym">if-false</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><h5>3.3.1.7<tt>&nbsp;</tt><a name="(part._.Updating_the_.Voltage)"></a>Updating the Voltage</h5><p>Look back at the <span class="math">\frac{dv}{dt}</span> formula for the <a href="#%28elem._iandf-eq%29" data-pltdoc="x">Integrate and Fire equation</a> and try to see the similarities. Although this function looks more complex it is still the basic Euler Method we used from the Integrate and Fire model. In fact, if you look at the source code for the <span class="RktSym">update</span><span class="RktMeta"></span> function you will see it is literally the one from the Integrate and Fire model.</p><p><div class="SIntrapara">Computing the Change of Voltage</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dvdt</span><span class="hspace">&nbsp;</span><span class="RktSym">voltage-now</span><span class="hspace">&nbsp;</span><span class="RktSym">curr-in</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">ena</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">ena</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">gna</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">gna</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">ek</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">ek</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">gk</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">gk</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">el</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">el</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">gl</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">gl</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">curr-in</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">gna</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expt</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktVal">3.0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">voltage-now</span><span class="hspace">&nbsp;</span><span class="RktSym">ena</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">gk</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expt</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktVal">4.0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">voltage-now</span><span class="hspace">&nbsp;</span><span class="RktSym">ek</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">gl</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">voltage-now</span><span class="hspace">&nbsp;</span><span class="RktSym">el</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Note that the looping construct we have been frequently using, the <span class="RktSym">for*/fold</span><span class="RktMeta"></span>, has an * in it. This means that later accumulator values can be declared dependent on ones that come before. This is not the case for <span class="RktSym">for/fold</span><span class="RktMeta"></span>, which declare the accumulators in parallel.</p></blockquote></blockquote></blockquote><p><div class="SIntrapara">Running the Model</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run-hh-sim</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:max-time</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">max-time</span><span class="hspace">&nbsp;</span><span class="RktVal">60.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:max-iter</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">max-iter</span><span class="hspace">&nbsp;</span><span class="RktVal">50000</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">dt</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">dt</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">init-v</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">init-v</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">for*/fold</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">init-t</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">accum</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:result</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reverse</span><span class="hspace">&nbsp;</span><span class="RktSym">accum</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">in-range</span><span class="hspace">&nbsp;</span><span class="RktSym">max-iter</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:break</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">max-time</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">values</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dvdt</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">accum</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><h5>3.3.1.7.1<tt>&nbsp;</tt><a name="(part._.Demonstrating_the_.Hodgkin-.Huxley_.Model)"></a>Demonstrating the Hodgkin-Huxley Model</h5><p><div class="SIntrapara">Running the HH Model</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">require</span><span class="hspace">&nbsp;</span><span class="RktVal">"./code/handh.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run-hh-sim</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-details</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lines</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">vector</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">second</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lines</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">vector</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">third</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict_7.png" alt="image" width="406" height="406"/></p></td></tr></table></blockquote></div></p><h5>3.3.1.8<tt>&nbsp;</tt><a name="(part._.Hodgkin_and_.Huxley_.Homework)"></a>Hodgkin and Huxley Homework</h5><p>I have given you code for this neuron in <a href="./../code/handh.rkt">handh.rkt</a>. Your homework will require you to modify this code and generate example plots of the output. You may find this harder than prior homeworks. Start sooner to see how it goes.</p><p>You will need to submit a scribble file. It should have a title, your name, and text describing each plot. You should provide at least two plots. You will need to adapt the model to fit this paper <span class="Autobibref">&nbsp;(<a href="#%28autobib._.Omar._.A..._.Hafez._and._.Allan._.Gottschalk.Altered._.Neuronal._.Excitability._in._a._.Hodgkin-.Huxley._.Model._.Incorporating._.Channelopathies._of._the._.Delayed._.Rectifier._.Potassium._.Channel.Journal._of._.Computational._.Neuroscience._48%2C._pp..._377--3862020http~3a%2F%2Fdx..doi..org%2F10..1007%2Fs10827-020-00766-1%29" class="AutobibLink" data-pltdoc="x">Hafez and Gottschalk</a> <a href="#%28autobib._.Omar._.A..._.Hafez._and._.Allan._.Gottschalk.Altered._.Neuronal._.Excitability._in._a._.Hodgkin-.Huxley._.Model._.Incorporating._.Channelopathies._of._the._.Delayed._.Rectifier._.Potassium._.Channel.Journal._of._.Computational._.Neuroscience._48%2C._pp..._377--3862020http~3a%2F%2Fdx..doi..org%2F10..1007%2Fs10827-020-00766-1%29" class="AutobibLink" data-pltdoc="x">2020</a>)</span>. These authors analyzed a series of inherited channelopathies (where ion channels are altered due to mutation) via simulation. In these conditions empirical measurements had been made on actual patients. The authors adapted the Hodgkin and Huxley model to permit them to explore the effects of such altered conductance on neuronal excitability. For this home work you will need to adapt the <span style="font-style: italic">n</span> equation to be as follows:</p><p><div class="math">\frac{dn}{dt} = \gamma_\tau (\gamma_\alpha \alpha_n (v&#8722;\Delta V)(1&#8722;n)&#8722; \gamma_\beta \beta_n (v&#8722; \Delta V)n)</div></p><p>Then you must select one of the sets of <span class="math">\gamma</span> from their <a href="https://link.springer.com/article/10.1007/s10827-020-00766-1/tables/1">Table 1</a> and plot the neuronal activity.</p><p>To start implement the new <span style="font-style: italic">n</span> channel and set all the <span class="math">\gamma</span>s to 1. This should work exactly like the old model. Generate a plot showing that it does. For the second plot generate the same plot with your altered <span class="math">\gamma</span> values.</p><p>To ease your transition to scribble I will accept it if you generate the plots as pngs in Dr Racket and then load them as images in your scribble document. For the submission give me the scrbl file, the image files, and the html output you generated (the .html file).</p><h5><a name="(part._ref~3ahandh)"></a>Hodgkin-Huxley References</h5><p><table cellspacing="0" cellpadding="0" class="AutoBibliography"><tr><td><p><span class="Autobibtarget"><a name="(autobib._.Omar._.A..._.Hafez._and._.Allan._.Gottschalk.Altered._.Neuronal._.Excitability._in._a._.Hodgkin-.Huxley._.Model._.Incorporating._.Channelopathies._of._the._.Delayed._.Rectifier._.Potassium._.Channel.Journal._of._.Computational._.Neuroscience._48,._pp..._377--3862020http~3a//dx..doi..org/10..1007/s10827-020-00766-1)"></a><span class="Autobibentry">Omar A. Hafez and Allan Gottschalk. Altered Neuronal Excitability in a Hodgkin-Huxley Model Incorporating Channelopathies of the Delayed Rectifier Potassium Channel. <span style="font-style: italic">Journal of Computational Neuroscience</span> 48, pp. 377&ndash;386, 2020. <a href="http://dx.doi.org/10.1007/s10827-020-00766-1"><span class="url">http://dx.doi.org/10.1007/s10827-020-00766-1</span></a></span></span></p></td></tr></table></p><h4>3.4<tt>&nbsp;</tt><a name="(part._.Morris_.Lecar_.Model)"></a>Morris Lecar Model</h4><h5>3.4.1<tt>&nbsp;</tt><a name="(part._.Work_in_.Progress)"></a>Work in Progress</h5><p>This section is a work in progress.</p><p>I want to discuss the benefits of simplifying models as well as show the use of direction plots and phase space diagrams.</p><p>At the moment I have working racket code, but I have not written up this section yet. I am adding this section now (Oct 2022) to have a way to make the <a href="./../code/morris-lecar.rkt">code</a> discoverable.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Computation_and_Cognition.html" title="backward to &quot;2 What is Computation and is Cognition Computable?&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Computational Modeling for Psychology&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Neural_Networks.html" title="forward to &quot;4 Neural Networks&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>