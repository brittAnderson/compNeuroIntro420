<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Hodgkin and Huxley Model of the Action Potential</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript">
(function() {document.write('<scr' + 'ipt type="text/javascript" src="MathJax/MathJax.js?config=default"></scr' + 'ipt>');})();
</script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Hodgkin and Huxley Model of the Action Potential</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Background%29" class="tocviewlink" data-pltdoc="x">Background</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.The_.H.H.M%29" class="tocviewlink" data-pltdoc="x">The HHM</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Coding_the_.H.H.M%29" class="tocviewlink" data-pltdoc="x">Coding the HHM</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Hodgkin_and_.Huxley_.Model_of_the_.Action_.Potential%29" class="tocsubseclink" data-pltdoc="x">Hodgkin and Huxley Model of the Action Potential</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Background%29" class="tocsubseclink" data-pltdoc="x">Background</a></td></tr><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._.Biographical_.Sources%29" class="tocsubseclink" data-pltdoc="x">Biographical Sources</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#%28part._.Model_.Description__detailed_%29" class="tocsubseclink" data-pltdoc="x">Model Description (detailed)</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.The_.H.H.M%29" class="tocsubseclink" data-pltdoc="x">The HHM</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Putting_it_together__.The_.H.H.M%29" class="tocsubseclink" data-pltdoc="x">Putting it together:<span class="mywbr"> &nbsp;</span> The HHM</a></td></tr><tr><td><span class="tocsublinknumber">2.1.1<tt>&nbsp;</tt></span><a href="#%28part._.Test_your_understanding%29" class="tocsubseclink" data-pltdoc="x">Test your understanding</a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.It_s_.Differential_.Equations_.All_the_.Way_.Down%29" class="tocsubseclink" data-pltdoc="x">It&rsquo;s Differential Equations All the Way Down</a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Getting_.Started%29" class="tocsubseclink" data-pltdoc="x">Getting Started</a></td></tr><tr><td><span class="tocsublinknumber">2.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Constants%29" class="tocsubseclink" data-pltdoc="x">Constants</a></td></tr><tr><td><span class="tocsublinknumber">2.4<tt>&nbsp;</tt></span><a href="#%28part._.Alpha_and_.Beta_.Formulas%29" class="tocsubseclink" data-pltdoc="x">Alpha and Beta Formulas</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Coding_the_.H.H.M%29" class="tocsubseclink" data-pltdoc="x">Coding the HHM</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._.Updating_the_.Voltage%29" class="tocsubseclink" data-pltdoc="x">Updating the Voltage</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><h2><a name="(part._.Hodgkin_and_.Huxley_.Model_of_the_.Action_.Potential)"></a>Hodgkin and Huxley Model of the Action Potential</h2><h3>1<tt>&nbsp;</tt><a name="(part._.Background)"></a>Background</h3><p>Hodgkin and Huxley, the people as well as their model, provide a nice example for how to structure one&rsquo;s education to do this sort of work, as well as providing an exemplary example of doing the work.</p><p>One of the lessons is that you need to train broadly.
You may not understand in the beginning what the problem is.
You will need to be prepared for it to appear, and when it does to be able to attack it.
For Hodgkin and Huxley this meant training in both the physical and non-physical sciences.
Each emphasized a different side of that divide, but both made sure they could converse across the divide.
If you want to apply computational tools to social science problems then you will need to make sure your course work and your practical skills bridge that divide too.</p><h4>1.1<tt>&nbsp;</tt><a name="(part._.Biographical_.Sources)"></a>Biographical Sources</h4><p>The Nobel Prize organization keeps biographies of all recipients <a href="https://www.nobelprize.org/prizes/medicine/1963/hodgkin/biographical/">Hodgkin</a>,  <a href="https://www.nobelprize.org/prizes/medicine/1963/huxley/biographical/">Huxley</a>.</p><p>This <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3424716/pdf/tjp0590-2571.pdf">article (pdf)</a> is a nice summary of the work. You might look for how long it took Huxley to calculate his simulation of one action potential numerically using the method, basically, that we will be using, and compare it to how long it takes you.</p><h4>1.2<tt>&nbsp;</tt><a name="(part._.Model_.Description__detailed_)"></a>Model Description (detailed)</h4><p>Gersnter&rsquo;s <a href="https://lcnwww.epfl.ch/gerstner/SPNM/node14.html#table-HH1">book&rsquo;s chapter</a> on the HHM goes into more detail than I do. If you have problems getting things to work, or just want a more detailed mathematical explanation this is an excellent resource.</p><h3>2<tt>&nbsp;</tt><a name="(part._.The_.H.H.M)"></a>The HHM</h3><p>Some introductory reminders and admonitions:</p><p>The current going in to the cell is what we inject.
The current coming out is the sum of the capacitance (due to the lipid bilayer), and the resistance (due to the ion channels).
This is *Kirchoff&rsquo;s* rule.</p><p>Recall that in the Integrate and Fire model we lumped all our ionic
events together into one term:</p><p><div class="math">\tau \frac{dV(t)}{dt} = -V(t) + R~I(t)</div></p><p>The HHM is basically the same except we have a resistance <span style="font-style: italic">for each ion channel</span> (ask yourself,before reading the next paragraph)  what those ions are or at least how many terms you will need).
The rule for currents in parallel is to apply Kirchoff&rsquo;s and Ohm&rsquo;s laws realizing that they all experience the same voltage, thus the currents sum.</p><p>But in the HHM we treat these different ionic components with their own terms to capture the difference between the Sodium (Na), Potassium (K), and negative anions (still lumped as "leak" l).</p><p><div class="math">\sum_i I_R(t) = \bar{g}_{Na} m^3 h (V(t) - E_{Na}) + \bar{g}_{K} n^4 (V(t) - E_{K}) + \bar{g}_{L} (V(t) - E_{L})</div></p><h4>2.1<tt>&nbsp;</tt><a name="(part._.Putting_it_together__.The_.H.H.M)"></a>Putting it together: The HHM</h4><p><div class="math">I_{tot} = I_r + I_C</div></p><p>By the same logic as for the integrate and fire <span class="math">I_C = c~\frac{dV}{dt}</span>.</p><p><div class="math">I_{tot} = \bar{g}_{Na} m^3 h (V(t) - E_{Na}) + \bar{g}_{K} n^4 (V(t) - E_{K}) + \bar{g}_{L} (V(t) - E_{L}) + c~\frac{dV}{dt}</div></p><p>Rearrange to get the <span class="math">\frac{dV}{dt}</span> on a side by itself.</p><p><div class="math">c~\frac{dV}{dt} = I_{tot} - (\bar{g}_{Na} m^3 h (V(t) - E_{Na}) + \bar{g}_{K} n^4 (V(t) - E_{K}) + \bar{g}_{L} (V(t) - E_{L}))\tag 1</div></p><h5>2.1.1<tt>&nbsp;</tt><a name="(part._.Test_your_understanding)"></a>Test your understanding</h5><p>You cannot program what you don&rsquo;t understand.
Sometimes people think that the act of programming will bring them understanding.
It doesn&rsquo;t.
It may provoke understanding.
It may be that you did not realize that you did not understand something until you try to code it.
That can be helpful.
But if you are fuzzy on the basics coding will not grant you insight.
Simulating models with code is most useful for helping you see the consequences of something.
If you understand the above model, what its components stand for and represent, then you might wonder what would happen if ...? What would happen if there were five <span style="font-style: italic">n</span> channel components? And so on.
It is not that you do not understand what <span style="font-style: italic">n</span> represents, but that you are unable to do the math in your head.
That is where the computer helps: making concrete the consequences of your well understood system.</p><p>So, in that light, and before you start coding, ask yourself,</p><ol><li><p>What are the <span class="math">\bar{g}_*</span> terms?</p></li><li><p>What are the <span class="math">E_{*}</span> terms?</p></li><li><p>What do m,n, and h represent?</p></li><li><p>Where did these equations come from?</p></li></ol><h4>2.2<tt>&nbsp;</tt><a name="(part._.It_s_.Differential_.Equations_.All_the_.Way_.Down)"></a>It&rsquo;s Differential Equations All the Way Down</h4><p>Although the HHM uses just the same mathematics as the I&amp;F model, and we will use the same Euler&rsquo;s method to step forward and calculate model terms that evolve over time, this model is more complex in two ways. First, it has multiple derivatives and derivatives at multiple levels. Each of the <span style="font-style: italic">m</span>, <span style="font-style: italic">n</span>, and <span style="font-style: italic">h</span> terms are also changing and regulated by a differential equation. They are dependent on voltage. For example, <span class="math">\dot{m} = \alpha_m (V)(1 - m) - \beta_m (V) m</span>.</p><p><div class="SIntrapara"><span style="font-weight: bold">More food for thought</span>
</div><div class="SIntrapara"><ol><li><p>Each of the m,n, and h terms have their own equation of exactly the same form, but with their unique alphas and betas (that is what the subscript means).</p></li><li><p>What does the V in parentheses mean?</p></li><li><p>When they were finally sequenced (decades later), what do you think was the number of sub-units that the sodium and potassium channels were found to have?</p></li></ol></div></p><h4>2.3<tt>&nbsp;</tt><a name="(part._.Getting_.Started)"></a>Getting Started</h4><p>You will need to make some assumptions to get your initial conditions.</p><ul><li><p>If you allow <span class="math">t \rightarrow \infty \mbox{, then } \frac{dV}{dt}=?</span></p></li><li><p>You assume that it goes to zero; that is, you reach steady state. Then you can solve for some of the constants.</p></li><li><p>Where do the constants come from?</p></li><li><p>They come from experiments, and you use what you are given.</p></li><li><p>Assume the following constants - they are set to assume a resting potential of zero (instead of what and why doesn&rsquo;t this matter)?</p></li><li><p>These constants also work out to enforce a capacitance of 1</p></li></ul><h5>2.3.1<tt>&nbsp;</tt><a name="(part._.Constants)"></a>Constants</h5><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Constant</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span style="font-weight: bold">Value</span></p></td></tr><tr><td><p>ena</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>115</p></td></tr><tr><td><p>gna</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>120</p></td></tr><tr><td><p>ek</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>-12</p></td></tr><tr><td><p>gk</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>36</p></td></tr><tr><td><p>el</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>10.6</p></td></tr><tr><td><p>gl</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>0.3</p></td></tr></table></p><p><span style="font-weight: bold">WARNING</span> These constants are adjusted to make the resting potential 0 and the capacitance 1.0. If you want your model to have a biological resting potential you will need to adjust these values, but when you think about it the scale is rather arbitrary. What does water freeze at 0 or -32? Well it depends on the scale: centigrade or fahrenheit. Same for neurons. Why not use a scale that makes the math simpler. Focus on the relative behavior not some absolute, and rather arbitrary, numbers?</p><h4>2.4<tt>&nbsp;</tt><a name="(part._.Alpha_and_.Beta_.Formulas)"></a>Alpha and Beta Formulas</h4><p><span class="math">\alpha_{n}(V_{m})={\frac {0.01(10-V_{m})}{\exp {\big (}{\frac{10-V_{m}}{10}}{\big )}-1}}</span></p><p><span class="math">\alpha_{m}(V_{m})={\frac {0.1(25-V_{m})}{\exp {\big (}{\frac {25-V_{m}}{10}}{\big )}-1}}</span></p><p><span class="math">\alpha _{h}(V_{m})=0.07\exp {\bigg (}{\frac {-V_{m}}{20}}{\bigg )}</span></p><p><span class="math">\beta _{n}(V_{m})=0.125\exp {\bigg (}{\frac {-V_{m}}{80}}{\bigg )}</span></p><p><span class="math">\beta _{m}(V_{m})=4\exp {\bigg (}{\frac {-V_{m}}{18}}{\bigg )}</span></p><p><span class="math">\beta_{h}(V_{m})={\frac {1}{\exp {\big (}{\frac {30-V_{m}}{10}}{\big)}+1}}</span></p><h3>3<tt>&nbsp;</tt><a name="(part._.Coding_the_.H.H.M)"></a>Coding the HHM</h3><p>We have a lot of variables and constants with particular values. It is inconvenient to keep entering each as a very long list of arguments, so we can construct a collection of all of them so we can pass around a single collection that will contain all the elements we need. It would also be convenient to be able to refer to them by name and not to have to remember their exact location in the collection. We can use a simple association list for this, but I will use a <span style="font-style: italic">hash-table</span>, which is more like a python dictionary.</p><p><div class="SIntrapara">Defining the Basic Neuron Parameters</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-details</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">dt</span><span class="hspace">&nbsp;</span><span class="RktVal">0.05</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">init-t</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">start-time</span><span class="hspace">&nbsp;</span><span class="RktVal">10.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">stop-time</span><span class="hspace">&nbsp;</span><span class="RktVal">34.05</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">cap</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">init-v</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">injection-current</span><span class="hspace">&nbsp;</span><span class="RktVal">20.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">ena</span><span class="hspace">&nbsp;</span><span class="RktVal">115.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">gna</span><span class="hspace">&nbsp;</span><span class="RktVal">120.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">ek</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>2.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">gk</span><span class="hspace">&nbsp;</span><span class="RktVal">36.0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">el</span><span class="hspace">&nbsp;</span><span class="RktVal">10.6</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">gl</span><span class="hspace">&nbsp;</span><span class="RktVal">0.3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">All the Helper Functions:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.01</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">2.5</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">2.5</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.07</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>.0</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">20.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.125</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>.0</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">80.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">4.0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>.0</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">18.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">exp</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">3.0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-m</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-n</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">/</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">alpha-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">beta-h</span><span class="hspace">&nbsp;</span><span class="RktSym">volt</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">lower</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">start-time</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">upper</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">stop-time</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">if-true</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">injection-current</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">if-false</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">if</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">and</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&gt;=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">lower</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&lt;=</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">upper</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">if-true</span><span class="hspace">&nbsp;</span><span class="RktSym">if-false</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><h4>3.1<tt>&nbsp;</tt><a name="(part._.Updating_the_.Voltage)"></a>Updating the Voltage</h4><p>Look back at the <span class="math">\frac{dv}{dt}</span> formula for the I&amp;F model and try to see the similarities. Although this function looks more complex it is still the basic Euler Method we used from the I&amp;F model. In fact, if you look where the <span class="RktSym">update</span><span class="RktMeta"></span> function comes from you will see it is literally the one from the I&amp;F model.</p><p><div class="SIntrapara">Computing the Change of Voltage</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dvdt</span><span class="hspace">&nbsp;</span><span class="RktSym">voltage-now</span><span class="hspace">&nbsp;</span><span class="RktSym">curr-in</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">ena</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">ena</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">gna</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">gna</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">ek</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">ek</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">gk</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">gk</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">el</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">el</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">gl</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-parameters</span><span class="RktVal">'</span><span class="RktVal">gl</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">curr-in</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">gna</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expt</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktVal">3.0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">voltage-now</span><span class="hspace">&nbsp;</span><span class="RktSym">ena</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">gk</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">expt</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktVal">4.0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">voltage-now</span><span class="hspace">&nbsp;</span><span class="RktSym">ek</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">gl</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-</span></span><span class="hspace">&nbsp;</span><span class="RktSym">voltage-now</span><span class="hspace">&nbsp;</span><span class="RktSym">el</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Running the Model</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run-hh-sim</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktPn">#:max-time</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">max-time</span><span class="hspace">&nbsp;</span><span class="RktVal">60.0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:max-iter</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">max-iter</span><span class="hspace">&nbsp;</span><span class="RktVal">50000</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">let</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">dt</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">dt</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">init-v</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">init-v</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">for*/fold</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-ref</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">init-t</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h-infinity</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">init-v</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">accum</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:result</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reverse</span><span class="hspace">&nbsp;</span><span class="RktSym">accum</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">in-range</span><span class="hspace">&nbsp;</span><span class="RktSym">max-iter</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:break</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">max-time</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">values</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">m-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">n-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">h-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">dvdt</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-m</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-n</span><span class="hspace">&nbsp;</span><span class="RktSym">hh-h</span><span class="hspace">&nbsp;</span><span class="RktSym">nps</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">dt</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">accum</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Testing
</div><div class="SIntrapara"><p><div class="SIntrapara">Running the HH Model</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">begin</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">require</span><span class="hspace">&nbsp;</span><span class="RktVal">"./../code/handh.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run-hh-sim</span><span class="hspace">&nbsp;</span><span class="RktSym">neuron-details</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">plot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lines</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">vector</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">second</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lines</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">vector</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">map</span><span class="hspace">&nbsp;</span><span class="RktSym">third</span><span class="hspace">&nbsp;</span><span class="RktSym">run</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="pict.png" alt="image" width="406" height="406"/></p></td></tr></table></blockquote></div></p></div></p></div></div><div id="contextindicator">&nbsp;</div></body></html>